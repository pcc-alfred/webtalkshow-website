---
interface Props {
  number: number
  title: string
  description: string
  date: Date
  duration: string
  slug: string
  guests?: string[]
  topics?: string[]
  index?: number
}

const { number, title, description, date, duration, slug, guests, topics, index = 0 } = Astro.props

const formattedDate = date.toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'short',
  day: 'numeric'
})

const paddedNumber = String(number).padStart(3, '0')
---

<a 
  href={`/episodes/${slug}`} 
  class="episode-row group block relative overflow-hidden rounded-lg transition-all duration-300"
  data-hover-bg
  style={`--stagger: ${index}; animation: fadeInUp 0.6s ease-out both; animation-delay: calc(var(--stagger) * 80ms);`}
>
  <!-- Red accent border on hover -->
  <div class="absolute left-0 top-0 bottom-0 w-[3px] bg-[#e63329] scale-y-0 group-hover:scale-y-100 transition-transform duration-300 origin-center rounded-full"></div>
  
  <div class="flex items-start gap-4 sm:gap-6 px-4 sm:px-6 py-5 group-hover:translate-x-1 transition-transform duration-300">
    <!-- Oversized episode number -->
    <div class="hidden sm:flex flex-shrink-0 w-20 items-center justify-center">
      <span class="font-[var(--font-display)] text-5xl font-extrabold transition-colors duration-500 select-none leading-none" style="color: var(--number-color)">
        {paddedNumber}
      </span>
    </div>
    
    <!-- Content -->
    <div class="flex-1 min-w-0">
      <!-- Mobile episode number -->
      <div class="sm:hidden text-xs text-[#e63329] font-semibold mb-1 tracking-wider uppercase">
        EP {paddedNumber}
      </div>
      
      <!-- Title -->
      <h3 class="font-[var(--font-display)] font-bold text-lg sm:text-xl leading-snug mb-2 group-hover:text-[#e63329] transition-colors duration-300 line-clamp-2" style="color: var(--text-heading);">
        {title}
      </h3>
      
      <!-- Description -->
      <p class="text-sm leading-relaxed line-clamp-2 mb-3" style="color: var(--text-muted);">{description}</p>
      
      <!-- Meta row -->
      <div class="flex flex-wrap items-center gap-3 text-xs" style="color: var(--text-muted);">
        <span>{formattedDate}</span>
        <span style="color: var(--border);">·</span>
        <span>{duration}</span>
        {guests && guests.length > 0 && (
          <>
            <span style="color: var(--border);">·</span>
            <span class="text-[#e63329]/70">with {guests.slice(0, 2).join(', ')}{guests.length > 2 ? ` +${guests.length - 2}` : ''}</span>
          </>
        )}
      </div>
      
      <!-- Topics -->
      {topics && topics.length > 0 && (
        <div class="flex flex-wrap gap-1.5 mt-3">
          {topics.slice(0, 3).map((topic) => (
            <span class="px-2 py-0.5 text-xs rounded-md group-hover:border-[#e63329]/20 transition-colors" style="background: var(--tag-bg); color: var(--tag-text); border: 1px solid var(--tag-border);">{topic}</span>
          ))}
          {topics.length > 3 && (
            <span class="px-2 py-0.5 text-xs" style="color: var(--text-muted); opacity: 0.5;">+{topics.length - 3}</span>
          )}
        </div>
      )}
    </div>
    
    <!-- Arrow indicator -->
    <div class="hidden sm:flex items-center self-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 text-[#e63329]">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
      </svg>
    </div>
  </div>
  
  <!-- Bottom divider -->
  <div class="mx-4 sm:mx-6 border-b" style="border-color: var(--border);"></div>
</a>
